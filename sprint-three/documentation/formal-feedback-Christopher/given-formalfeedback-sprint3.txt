The code looks good. I noticed that you added a flagging system in your code in java which seems to work great and I though was very instersting.